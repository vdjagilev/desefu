author: Vsevolod Djagilev
meta:
  description: |
    This config file is specifically needed to search for message databases on
    phone. It traverses all possible files (mainly it's SQLite databases)
    and extracts the data

search:
  sqlite_dbs:
    -
      mod: file.Extension
      args: ['', 'sqlite', 'sqlite3', 'db']
    -
      mod: file.FileHeader
      args:
        types:
          - [53, 51, 4C, 69, 74, 65, 20, 66, 6F, 72, 6D, 61, 74, 20, 33] # SQLite format 3
    -
      mod: search.Dictionary
      args:
        dictionary:
          - './tests/modules/search/dictionaries/dictionary1.txt'
          #- './tests/modules/search/dictionaries/dictionary2.txt'
        encoding: # https://docs.python.org/3/library/codecs.html#standard-encodings
          - 'utf-8'
          - 'ascii'
          - 'latin-1'
          - 'cp866'
      sub:
        -
          mod: file.type.SqliteDatabase
          extract:
            columns:
              - result # Columns where evidence were found (from parent Dictionary module)
              - timestamps # Possible timestamp values
              - id # Fields which might be identifiers - contain "id" keyword
            where:
              - ~mod.3.data.0 # "~" is a reference to module number 3, collected data column with index 0
            order:
              timestamps: DESC
            result:
              - columns # Also possible to fetch whole table, or some rows where information were found
    -
      mod: file.Hash
