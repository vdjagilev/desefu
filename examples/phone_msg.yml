author: Vsevolod Djagilev
meta:
  description: |
    This config file is specifically needed to search for message databases on
    phone. It traverses all possible files (mainly it's SQLite databases)
    and extracts the data

search:
  sqlite_dbs:
    -
      mod: file.Extension
      args: ['', 'sqlite', 'sqlite3', 'db']
    -
      mod: file.FileHeader
      args:
        types: 
          - [53, 51, 4C, 69, 74, 65, 20, 66, 6F, 72, 6D, 61, 74, 20, 33] # SQLite format 3
    -
      mod: search.Dictionary
      args:
        - '/path/to/dictionary_words.txt'
      sub:
        -
          mod: file.type.SqliteDatabase
          extract:
            columns: [result, timestamps] # Result columns and tries to get timestamps
            order:
              timestamps: DESC
            result:
              - columns # Also possible to fetch whole table, or some rows where information were found

extract:
  sqlite_dbs:
    format:
      - csv
      - html
      - xlsx
      - pdf
    output: report_result # By default timestamp.{format}
